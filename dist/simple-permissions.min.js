/*! simple-permissions - v5.0.1 - 2016-03-26
* https://github.com/szarouski/simple-permissions
 Licensed Unlicense
* Description Trivial permissions implementation - takes an array and stores permissions from multiple targets for sources. 100% tested.
* Author Sergey Zarouski, http://webuniverse.io
*/

!function(a,b){"use strict";var c="object"!=typeof window;if("function"==typeof define&&define.amd)define(["exports","_"],b);else if("object"==typeof exports)b(c?exports:exports.permissions={},require(c?"lodash":"_"));else{var d=a.exports||(a.exports={});b(d.permissions={},a._)}}(this,function(a,b){"use strict";function c(a,b,c){this.target=a,this.source=b,this.permissions=c}function d(a,c,d){c=f(c),b.each(c,b.partial(g,a,d,h))}function e(a,c,d){c=f(c),b.each(c,b.partial(g,a,d,i))}function f(a){return b.isArray(a)||(a=[a]),a}function g(a,c,d,e){b.each(c,b.partial(d,e,a))}function h(a,d,e,f){var g=b.find(d,{target:a,source:f});g?g.addPermissions(e):new c(a,f,e).addToStorage(d)}function i(a,c,d,e){var f=b.find(c,{target:a,source:e});f&&(f.removePermissions(d),f.removeFromStorageWhenEmpty(c))}c.prototype={constructor:c,addPermissions:function(a){this.permissions=b.union(this.permissions,a)},removePermissions:function(a){this.permissions=b.difference(this.permissions,a)},addToStorage:function(a){a.push(this)},removeFromStorageWhenEmpty:function(a){if(!this.permissions.length){var c=b.indexOf(a,this);a.splice(c,1)}}};var j=a;j.grant=d,j.revoke=e});